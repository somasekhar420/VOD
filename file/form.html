<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vehicle Entry Form</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
  :root{
    --bg: linear-gradient(135deg,#a1c4fd,#c2e9fb,#fbc2eb);
    --card: rgba(255,255,255,0.1);
    --accent:#d4af37;
    --white:#fff;
    --muted:#333;
  }
  body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background: var(--bg);
    color: var(--white);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    padding:20px;
  }
  .card{
    background: var(--card);
    padding:24px;
    border-radius:16px;
    max-width:500px;
    width:100%;
    box-shadow: 0 0 20px rgba(0,0,0,0.2);
  }
  h2{text-align:center;color:var(--accent);}
  label{display:block;margin-top:12px;margin-bottom:4px;color:var(--muted);}
  input,select{width:100%;padding:10px;border-radius:8px;border:none;background:rgba(255,255,255,0.2);color:#000;}
  button{margin-top:16px;width:100%;padding:10px;border:none;border-radius:8px;background:var(--accent);color:#000;font-weight:600;cursor:pointer;transition:0.3s;}
  button:hover{background:#fff;color:var(--accent);}
  .msg{margin-top:12px;padding:10px;border-radius:8px;text-align:center;}
  .msg.success{background:rgba(30,80,30,0.2);color:#b8f0b8;}
  .msg.error{background:rgba(80,20,20,0.2);color:#ffb3b3;}
</style>
</head>
<body>

<div class="card">
  <h2>Vehicle Entry Form</h2>
  <form id="entryForm">
    <label>Name</label><input type="text" name="name" required>
    <label>Contact</label><input type="text" name="contact" required>
    <label>Aadhaar</label><input type="text" name="aadhaar" required>
    <label>Age</label><input type="number" name="age" required>
    <label>Vehicle No</label><input type="text" name="vehicleNo" required>
    <label>Model / Year</label><input type="text" name="model" required>
    <label>Type</label>
    <select name="type" required>
      <option value="">Select Type</option>
      <option>Bajaj CNG</option>
      <option>Bajaj Diesel</option>
      <option>TVS CNG</option>
      <option>TVS Diesel</option>
      <option>EV</option>
      <option>Electrical</option>
      <option>Other</option>
    </select>
    <button type="submit">Submit</button>
    <div id="msgArea"></div>
  </form>
</div>

<script>
const form=document.getElementById('entryForm');
const msgArea=document.getElementById('msgArea');

// --- Google Sheet URL: CHANGE HERE ---
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxCqiK6fCGbEbxIIA9c4kq7t-HHdMG9dE_zWEgQuiq6_PGCsRcMwzwIfmvawO5joGu2lA/exec"; // <-- Add your Google Sheet Apps Script URL here

// --- Utility ---
function showMsg(txt,type='success'){
  msgArea.innerHTML=`<div class="msg ${type}">${txt}</div>`;
  setTimeout(()=>{ msgArea.innerHTML=''; },3000);
}

// --- Token validation ---
const params=new URLSearchParams(window.location.search);
const token=params.get('token');
if(!token){showMsg('Invalid access. Token missing','error'); form.style.display='none';}

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const data={
    id: 'id-'+Date.now()+'-'+Math.random().toString(36).slice(2,6),
    token,
    date: Date.now()
  };
  new FormData(form).forEach((v,k)=>data[k]=v);
  
  // --- Save locally ---
  const records=JSON.parse(localStorage.getItem('records')||'[]');
  records.push(data);
  localStorage.setItem('records',JSON.stringify(records));
  
  // --- Send to Google Sheet ---
  try{
    await fetch(SHEET_URL,{method:'POST',body:JSON.stringify(data),mode:'no-cors'});
  }catch(e){console.warn('Sheet submit failed',e);}
  
  showMsg('Submitted successfully','success');
  form.reset();
});
</script>

</body>
</html>
